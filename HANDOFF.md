# ğŸ”„ Handoff Document - ForgeERP

**Date:** 2025-11-05  
**Status:** MVP in progress, English translation completed  
**Next Chat:** Continue from here

---

## ğŸ“‹ Current Status

### âœ… Completed

1. **Internationalization (i18n)**
   - âœ… React i18next configured (`frontend/src/i18n/`)
   - âœ… English translations implemented (`frontend/src/i18n/locales/en.json`)
   - âœ… All frontend components translated to English
   - âœ… Backend API messages in English
   - âœ… All documentation translated to English

2. **Cursor/VS Code Configuration**
   - âœ… `.vscode/settings.json` - React/TypeScript workspace settings
   - âœ… `.vscode/extensions.json` - Recommended extensions
   - âœ… `.cursorrules` - Cursor AI assistant rules
   - âœ… `install-cursor-extensions.sh` - Script to install extensions

3. **Documentation**
   - âœ… English step-by-step guide generated (`docs/operacional/STEP_BY_STEP_GUIDE.md`)
   - âœ… Screenshots generated automatically via E2E tests
   - âœ… All documentation references updated

4. **Git History**
   - âœ… Single English MVP commit (history rewritten)
   - âœ… No Portuguese references in commits

5. **Core Features**
   - âœ… Docker unified image (frontend + backend + CLI)
   - âœ… SQLite database
   - âœ… FastAPI serving static frontend + API
   - âœ… CLI (`forge` commands)
   - âœ… Authentication (JWT)
   - âœ… Client CRUD
   - âœ… Configuration management
   - âœ… E2E tests with Playwright

---

## ğŸ—ï¸ Architecture

### Tech Stack

**Frontend:**
- React 19 + TypeScript
- Vite (build tool)
- Tailwind CSS
- React Router DOM (routing)
- react-i18next (internationalization)

**Backend:**
- FastAPI (Python 3.11)
- SQLModel (ORM - Pydantic + SQLAlchemy)
- SQLite (database)
- JWT authentication
- Playwright (E2E tests)

**Infrastructure:**
- Docker (unified image)
- Docker Compose (local development)
- GitHub Actions (CI/CD)
- GHCR (GitHub Container Registry)

**CLI:**
- Typer + Rich (Python)

### Project Structure

```
forgeerp/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ forgeerp/
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI app (serves API + static frontend)
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ database/       # Models and database
â”‚   â”‚   â”‚   â”œâ”€â”€ api/            # API routes
â”‚   â”‚   â”‚   â”œâ”€â”€ engine/         # GitHub workflow generation
â”‚   â”‚   â”‚   â””â”€â”€ services/       # Business logic
â”‚   â”‚   â””â”€â”€ addons/             # Odoo-like modules
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ e2e/                # E2E tests (Playwright)
â”‚   â”‚   â”‚   â”œâ”€â”€ test_guia_completo.py  # Generates STEP_BY_STEP_GUIDE.md
â”‚   â”‚   â”‚   â”œâ”€â”€ conftest.py     # E2E fixtures
â”‚   â”‚   â”‚   â””â”€â”€ utils.py        # React wait utilities
â”‚   â”‚   â”œâ”€â”€ integration/        # Integration tests
â”‚   â”‚   â””â”€â”€ unit/               # Unit tests
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # React components
â”‚   â”‚   â”œâ”€â”€ pages/              # Page components
â”‚   â”‚   â”œâ”€â”€ lib/                # Utilities (API client, auth)
â”‚   â”‚   â””â”€â”€ i18n/               # i18n configuration
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ cli/
â”‚   â””â”€â”€ forgeerp/
â”‚       â””â”€â”€ cli/
â”‚           â””â”€â”€ main.py         # CLI commands
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ funcional/              # Functional documentation (GUI)
â”‚   â”œâ”€â”€ tecnica/                # Technical documentation (GUI + CLI)
â”‚   â””â”€â”€ operacional/            # Auto-generated documentation
â”‚       â”œâ”€â”€ STEP_BY_STEP_GUIDE.md  # Generated by E2E tests
â”‚       â””â”€â”€ screenshots/       # Generated screenshots
â”‚
â”œâ”€â”€ .vscode/                    # VS Code/Cursor configuration
â”œâ”€â”€ Dockerfile                   # Unified image build
â”œâ”€â”€ docker-compose.yml           # Local development
â””â”€â”€ README.md                    # Main documentation
```

---

## ğŸš€ Quick Start

### Prerequisites

- Docker & Docker Compose
- Git
- Node.js (for local frontend development)
- Python 3.11+ (for local backend development)

### Installation

1. **Clone repository:**
   ```bash
   git clone https://github.com/forgeerp/forgeerp.git
   cd forgeerp
   ```

2. **Install Cursor extensions (recommended):**
   ```bash
   ./install-cursor-extensions.sh
   ```

3. **Start application:**
   ```bash
   # Using Docker (recommended)
   docker compose up -d
   
   # Or using CLI
   forge up
   ```

4. **Create admin user:**
   ```bash
   forge user
   # Default: admin / admin
   ```

5. **Access application:**
   - Frontend: http://localhost:8000
   - API Docs: http://localhost:8000/docs

---

## ğŸ› ï¸ Development

### Backend Development

```bash
cd backend

# Install dependencies
pip install -r requirements.txt

# Run tests
make test
make test-e2e
make test-coverage

# Generate documentation
make docs-e2e  # Generates STEP_BY_STEP_GUIDE.md
```

### Frontend Development

```bash
cd frontend

# Install dependencies
npm install

# Run dev server
npm run dev

# Build
npm run build
```

### CLI Commands

```bash
forge up          # Start application
forge down        # Stop application
forge status      # Check status
forge logs        # View logs
forge test        # Run tests
forge user        # Create admin user
```

---

## ğŸ“š Key Files

### Configuration

- **`.vscode/settings.json`** - Workspace settings for React/TypeScript
- **`.vscode/extensions.json`** - Recommended VS Code/Cursor extensions
- **`.cursorrules`** - Rules for Cursor AI assistant
- **`docker-compose.yml`** - Local development setup
- **`Dockerfile`** - Unified image (frontend + backend + CLI)

### Core Code

- **`backend/forgeerp/main.py`** - FastAPI app entry point
- **`frontend/src/App.tsx`** - React app entry point
- **`frontend/src/i18n/config.ts`** - i18n configuration
- **`frontend/src/i18n/locales/en.json`** - English translations
- **`cli/forgeerp/cli/main.py`** - CLI commands

### Tests & Documentation

- **`backend/tests/e2e/test_guia_completo.py`** - Generates step-by-step guide
- **`backend/tests/e2e/utils.py`** - React wait utilities (`wait_for_react`, `wait_for_navigation_complete`)
- **`docs/operacional/STEP_BY_STEP_GUIDE.md`** - Auto-generated user guide

---

## ğŸ”§ Technical Decisions

### 1. Unified Docker Image
- **Decision:** Single Docker image containing frontend, backend, and CLI
- **Reason:** Simplifies deployment (Portainer-style)
- **Benefit:** `docker pull` + `docker run` = ready to use

### 2. SQLite Database
- **Decision:** SQLite for MVP
- **Reason:** Lightweight, no external dependencies
- **Future:** PostgreSQL as optional module

### 3. React 19 + TypeScript
- **Decision:** Modern React with strict typing
- **Reason:** Type safety, better DX
- **i18n:** react-i18next for translations

### 4. E2E Documentation Generation
- **Decision:** Generate documentation from E2E tests
- **Reason:** Always up-to-date, no manual maintenance
- **Implementation:** `pytest tests/e2e/test_guia_completo.py --generate-docs`

### 5. React Wait Utilities
- **Decision:** Abstract React hydration waiting
- **Reason:** Avoid arbitrary `time.sleep()` calls
- **Location:** `backend/tests/e2e/utils.py`

---

## ğŸš§ What's Missing / TODO

### High Priority

1. **Frontend - Complete Pages**
   - [ ] Modules management page
   - [ ] Environments management page
   - [ ] Onboarding wizard
   - [ ] Better error handling UI
   - [ ] Loading states
   - [ ] Toast notifications

2. **Backend - API Routes**
   - [ ] Complete modules API (install/uninstall)
   - [ ] Environments API (CRUD)
   - [ ] Workflow generation API
   - [ ] GitHub integration API

3. **Features**
   - [ ] Module installation system
   - [ ] Environment provisioning
   - [ ] GitHub workflow generation
   - [ ] Permission system (GitHub PR integration)

### Medium Priority

4. **Documentation**
   - [ ] Translate remaining Portuguese docs
   - [ ] API documentation examples
   - [ ] Architecture diagrams

5. **Testing**
   - [ ] More E2E test coverage
   - [ ] Integration tests for modules
   - [ ] Performance tests

### Low Priority

6. **Polish**
   - [ ] UI/UX improvements
   - [ ] Accessibility (a11y)
   - [ ] Internationalization (other languages)

---

## ğŸ” Important Notes

### React Hydration
- Use `wait_for_react()` after `page.goto()` in E2E tests
- Use `wait_for_navigation_complete()` after navigation
- Located in `backend/tests/e2e/utils.py`

### Documentation Generation
- Run: `pytest tests/e2e/test_guia_completo.py --generate-docs -v`
- Or: `make docs-e2e`
- Output: `docs/operacional/STEP_BY_STEP_GUIDE.md`
- Screenshots: `docs/operacional/screenshots/`

### Cursor/VS Code Setup
- Install recommended extensions: `./install-cursor-extensions.sh`
- Reload window after installing extensions
- TypeScript uses workspace version automatically

### Database
- SQLite file: `data/forgeerp.db`
- Reset: `forge reset` (âš ï¸ deletes all data)

### Docker Images
- Production: `ghcr.io/forgeerp/forgeerp:latest`
- Local build: `docker build -t forgeerp:local .`
- GitHub Actions builds and pushes to GHCR automatically

---

## ğŸ› Known Issues

1. **E2E Tests**
   - Some tests may need longer timeouts for React hydration
   - Screenshot generation requires container to be running

2. **Frontend**
   - Some components may need better error handling
   - Loading states could be improved

3. **Documentation**
   - Some older Portuguese docs may still exist (check `docs/`)

---

## ğŸ“ Recent Changes

### Latest Commits

1. **Cursor/VS Code Configuration**
   - Added `.vscode/settings.json` for React/TypeScript
   - Added `.cursorrules` for AI assistant
   - Created `install-cursor-extensions.sh`

2. **English Translation**
   - Translated all frontend components
   - Translated backend API messages
   - Translated all documentation
   - Generated English step-by-step guide

3. **Documentation**
   - Renamed `GUIA_PASSO_A_PASSO.md` â†’ `STEP_BY_STEP_GUIDE.md`
   - Updated all references
   - Generated new screenshots

---

## ğŸ¯ Next Steps (Suggested)

1. **Complete Frontend Pages**
   - Implement Modules page
   - Implement Environments page
   - Add Onboarding wizard

2. **Backend API**
   - Complete modules installation system
   - Implement environment provisioning
   - Add workflow generation

3. **Testing**
   - Add more E2E tests
   - Improve test coverage
   - Add integration tests

4. **Documentation**
   - Complete API documentation
   - Add architecture diagrams
   - Create developer guide

---

## ğŸ”— Useful Commands

```bash
# Development
forge up              # Start app
forge down            # Stop app
forge logs --follow   # Follow logs
forge test            # Run tests

# Docker
docker compose up -d           # Start services
docker compose down            # Stop services
docker compose logs -f backend # Backend logs
docker compose exec backend bash # Shell into container

# Testing
cd backend
make test              # All tests
make test-unit         # Unit tests
make test-integration  # Integration tests
make test-e2e          # E2E tests
make docs-e2e         # Generate documentation

# Frontend
cd frontend
npm run dev            # Dev server
npm run build          # Build
npm run lint           # Lint

# Database
forge reset            # Reset database (âš ï¸ deletes all data)
forge user             # Create admin user
```

---

## ğŸ“ Support

- **Repository:** https://github.com/forgeerp/forgeerp
- **Documentation:** `docs/` directory
- **Issues:** GitHub Issues
- **Main README:** `README.md`

---

## âœ¨ Tips for Next Chat

1. **Start with:** "Continue from HANDOFF.md"
2. **Check:** Current TODO list
3. **Review:** Recent commits in GitHub
4. **Test:** Run `forge test` to verify everything works
5. **Documentation:** Check `docs/operacional/STEP_BY_STEP_GUIDE.md` for implemented features

---

**Good luck with the next phase! ğŸš€**

